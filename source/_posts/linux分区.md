---
title: linux磁盘分区、挂载
excerpt: linux入门第二站（水）
tags: linux
categories: linux
quicklink: true
date: 2023-11-8 11:30:00

---

<!DOCTYPE html>

# linux分区

## 说明

1. 刚刚学习linux的时候，特别是装上系统的时候，开始配置虚拟界面，硬盘大多数人填的都是20g，然后填完了之后，就会让你分区，如果是自动分区的那就没有体验到分区这一步，分区还是自己分才会更加了解。一开始的那个分区基本上是 根分区、/boot分区、交换分区（这三个分区的作用得牢记），linux中的每一个分区都是用来组成linux系统的一部分

2. linux采用了一种"载入"的处理方式，将分区和文件系统的目录联系起来。比如说刚开始的那块20g的硬盘，我们将它分了三个区，其中一个区对应着linux文件系统下的根目录，其中一个区对应linux文件系统下的/boot，其中一个区对应linux文件系统下的swap。它们联系起来，我们在某个目录下创建文件，其实看起来是存放在那个目录下，<mark>实则是在存放在了硬盘中与那个目录对应的分区下</mark>

## 硬盘

了解一下：linux硬盘分IDE硬盘和SCSI硬盘，目前基本上都是SCSI硬盘

先了解一两个指令：<span style="color:red">lsblk</span> 和 <span style="color:red">lsblk -f</span>，这两个指令，这两个指令都是显示设备的挂载情况。前一个指令执行后，可以清楚的看到NAME下一个sda，这个是什么意思呢？其实就是代表这是第一个SCSI硬盘，如果是sdb，就是第二个SCSI硬盘，sdc就是第三个SCSI硬盘，依次类推，当然，现在我们只有一块20g的磁盘，那就只有一个sda才对。之后的那些sda1、sda2、sda3 就代表着在这一块磁盘下的第几个分区。

![](/images/linux_02.png)

每一个分区对应的MOUNTPOINT就是挂载的目录了，自行体会

<br>

如果是后一个指令，那么FSTYPE是分区类型，UUID是分区的唯一识别码，每一个分区都会对应不同的识别码，其他的都大差不差了







## 进入正题

如果我们20个g的硬盘容量用到后面不够用了怎么办，那很明显，我们可以新增加一个硬盘（方便测验，我将容量调到了0.01g，~~是有点小家子气~~），然后将这个硬盘给分区，再将每个区对应上linux文件夹系统下的目录（其实就是挂载），那就可以解决了



### 虚拟机添加硬盘

这步就是在虚拟机里面找到硬盘，自己添加一块新的，注意类型要是SCSI的硬盘，大小自己定(10m😄)，添加前后可以多用用 lsblk 指令看看情况 ，会发现并没有什么变化。是的，虚拟机添加了硬盘之后，还需要重启，直接reboot。重启之后再lsblk就会发现多了一块磁盘sdb



### 分区

已经将硬盘加进来了，现在就得给这块空空的硬盘分区了。

记住一个重要的分区命令：<span style="color:red">fdisk /dev/sdb</span>，之前说过dev是和硬件有关的目录吧，dev下的sdb硬盘很好理解吧，执行完上述命令后，就进入到了一个界面，有以下参数可以选择

- m 显示命令列表————给你看那些参数有哪些用的

- p 显示硬盘分区

- n 新增分区———— 我们要新增分区，那待会就应该是按n

- d 删除分区———— 删除这个分区，注意是分区！

- w 写入并退出 ———— 保存操作用的

那明显，我们现在是要新增分区，那就选择n，之后它又会问是扩展分区(extended)还是主分区(primary partition)，要你安装几个分区。都可以自行选择，分区新增好了之后，可以再试一下lsblk指令，会发现，sdb下多出来了几个分区。可是lsbkl -f 会发现多出来的分区并没有类型，也没有UUID，更没有挂载的目录。

- 格式化磁盘 mkfs -t  ext4 /dev/sdb1 ，ext4是类型，这一步将磁盘的这个分区格式化

- 完成上一步后现在就有了分区类型，UUID，现在只需要选择一个挂载的目录就可以了
  
  - mount /dev/sdb1 /newdisk ，即将sdb下的第一个分区挂载到文件目录 /newdisk下

- 现在就可以正常使用这个文件夹了，你可以在里面存放文件了

- 如果想取消挂载， umount /dev/sdb1 或者 umount /newdist 都可以取消挂载，不过虽然取消了挂载，可是存在硬盘里的文件不会消失掉。

ps：<mark>用命令行挂载，重启后会失效</mark>



以上步骤需要自己独立完成几遍

### 额外步骤

以上步骤虽然有用，但是重启之后会失效，一种永久挂载的方式是通过修改/etc/fstab 实现挂载，添加完成后执行mount -a 即刻生效。





# 磁盘情况指令



- 查询磁盘整体占用情况
  
  - df -h

- 统计/opt下文件夹下的个数
  
  - ls -l /opt | grep "^-"| wc -l

- 统计/opt下的目录个数
  
  - ls -l /opt | grep "^d"| wc -l

- 统计/opt下的文件夹个数，包括子文件夹里的文件
  
  - ls -lR /opt | grep "^-"| wc -l

- 统计/opt下的目录个数，包括子目录里的目录个数
  
  - ls -lR /opt | grep "^d"| wc -l

ps：执行指令 yum install tree

之后以tree 目录 就可以以一个树形目录显示在控制台上，更加直观
















